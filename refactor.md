## Ход мыслей как рефакторил

### Беглый взгляд 
- не было проверки на ошибки при json.NewDecoder(r.Body).Decode(&newOrder) and decode
- валидация для newOrder.From и newOrder.To и т.п.
- hotel_id room_id не проверялся при проверки свободных комнат/дат

1. уменьшим связанность кода - для тестирования + расширение 
добавим слой handler - где опишем как будем обрабатывать запросы, надо вынести 2 функциональности
- проверка комнаты 
- добавление заказа

2. скроем логику добавления заказа в отдельный сервис который будет принимать данные заказа
просто вынесем всю бизнес логику в сервис order
будем возвращать определенные ошибки, для корректного установки статуса

3. вынесим логику проверки комнат в отдельны сервис
логику перенесли, теперь хранение данных вынесем в отдельный слой репо + уменьшим связанность кода

4. между слоями перемапливаем, чтоб не было зависимостей

5. не нравится что create order делает 2 вещи создает заказ и букает комнату
надо будет вынести в отдельную сущность которая будет это вызывать

6. пока что запущу проверю что все ок.

7. добавлю composite который будет собирать все зависимости для handler(все в одном месте)
пока все работает, ничего не падает, вынесу создание заказа в usecase.
теперь сервисы работают изолированно, никто никого не ждет.

8. при бронировании комнаты там O(n^2) это можно исправить, через map-у по дате
единственное возможно не лучшая идея т.к. была проверка через time.Equal() - которая учитывала time zone
- тут бы уточнил как бы приходили данные и приводить к одному формату

9. теперь можно добавить тесты, т.к. все зависимости вынесены в интерфейсы
добавил пример теста, в таком же духе можно добавить остальные тесты.

10. Логирование вынес на самый верхний слой, ошибка логируем один раз на уровне handler
11. Вынес парсинг env в конфиг.
12. логирование вынес в отдельный пакет

### Потенциалные доработки
- без tr manager будет конечно не очень приятно работать (забукали номер, но не создали заказ т.к что-то пошло не так). добавить tr manager
- добавить больше тестов не только моков, но и интеграционные тесты, создать httptest.server и в него добавить Handler и написать тесты, которые уже будут проверять все цепочку
- добавить router (chi/gin) - в них есть полезные обвязки, т.к. группировка ручек по доступности(open/close/jwt), логирование, метрики, возврат ошибки из handler делает сбор метри и логирование более удобным
- парсинг конфига через библиотечку + добавить тэги с дефольтными значениями
- добавить докер файл для сборки, docker ignore и тп.
- добавить ci - линтер + сборка + тесты



## Как запустить тесты
### с помощью go test
```sh
go test ./... -race
```
### с помощью make
```sh
make unit-tests
```
